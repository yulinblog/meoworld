import{p as C,ah as x,ai as B,v as f,aj as A,e as i,m as s,C as u,c as M,w as o,a as r,y as E,O as I,a1 as T,a2 as K,o as l,F as v,r as N,A as y,t as O,I as j,Q as F,R,E as w,h as b,ak as U,_ as z}from"./index-238de57f.js";import{_ as D}from"./avatar_user-8297f98c.js";import{_ as P}from"./avatar_assistant-89e6abce.js";import{_ as W}from"./AnimationBot2.vue_vue_type_script_setup_true_lang-453a4057.js";import{W as $}from"./style-74c83a5c.js";const m=d=>(T("data-v-59389b37"),d=d(),K(),d),q={class:"chat-bot"},H={class:"messsage-area"},J={key:0},L={class:"pa-5 user-message"},Q={class:"message align-center"},Y=m(()=>s("img",{src:D,alt:"alt"},null,-1)),G={key:1},X={class:"pa-5 assitant-message"},Z={class:"message"},ee=m(()=>s("img",{src:P,alt:"alt"},null,-1)),se={key:1,class:"no-message-container"},te=m(()=>s("h1",{class:"text-h4 text-md-h2 text-blue-lighten-1 font-weight-bold"}," Ask Me Any Thing ",-1)),ae={class:"input-area"},oe=C({__name:"ChatBot",setup(d){const _=x(),h=B(),n=f([]),c=f(""),g=async()=>{c.value&&(n.value.push({content:c.value,role:"user"}),c.value="",await S())},S=async()=>{var e;if(!h.getApiKey){_.showErrorMessage("请先输入API KEY");return}try{const t=await fetch("https://api.openai.com/v1/chat/completions",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${h.getApiKey}`},method:"POST",body:JSON.stringify({messages:n.value,model:"gpt-3.5-turbo",stream:!0})});if(!t.ok){const a=await t.json();_.showErrorMessage(a.error.message);return}const p=(e=t.body)==null?void 0:e.getReader();p||_.showErrorMessage("Cannot read the stream."),n.value.push({content:"",role:"assistant"}),U(p,n)}catch(t){_.showErrorMessage(t.message)}},V=()=>{const e=document.querySelector(".message-container");e==null||e.scrollTo({top:e==null?void 0:e.scrollHeight})};return A(()=>n.value,e=>{e&&V()},{deep:!0}),(e,t)=>{const p=I("perfect-scrollbar");return l(),i("div",q,[s("div",H,[u(n).length>0?(l(),M(p,{key:0,class:"message-container"},{default:o(()=>[(l(!0),i(v,null,N(u(n),a=>(l(),i(v,null,[a.role==="user"?(l(),i("div",J,[s("div",L,[s("div",Q,[r(y,{class:"mr-4 mr-lg-8"},{default:o(()=>[Y]),_:1}),s("b",null,O(a.content),1)])])])):(l(),i("div",G,[s("div",X,[s("div",Z,[r(y,{class:"mr-4 mr-lg-8"},{default:o(()=>[ee]),_:1}),r(u($),{modelValue:a.content,"onUpdate:modelValue":k=>a.content=k,previewOnly:""},null,8,["modelValue","onUpdate:modelValue"])])])]))],64))),256))]),_:1})):(l(),i("div",se,[te,r(W,{size:300})]))]),s("div",ae,[r(E,{elevation:"0",class:"input-panel","max-width":"1200"},{default:o(()=>[r(j,{color:"primary",ref:"input",modelValue:u(c),"onUpdate:modelValue":t[0]||(t[0]=a=>F(c)?c.value=a:null),placeholder:"SendMessage","hide-details":"",onKeyup:R(g,["enter"])},{"prepend-inner":o(()=>[r(w,null,{default:o(()=>[b("mdi-microphone")]),_:1})]),"append-inner":o(()=>[r(w,{onClick:g},{default:o(()=>[b("mdi-send")]),_:1})]),_:1},8,["modelValue","onKeyup"])]),_:1})])])}}});const de=z(oe,[["__scopeId","data-v-59389b37"]]);export{de as default};
