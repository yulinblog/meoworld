import{_ as ae}from"./avatar_user-8297f98c.js";import{_ as oe}from"./avatar_assistant-89e6abce.js";import{p as L,o as i,c as g,C as a,a0 as le,_ as S,e as p,at as P,v as x,aj as W,x as ne,a as e,w as s,E as N,h as r,am as q,q as z,f as w,d as ie,G as M,z as k,g as U,D as j,ab as ce,ac as de,m as t,t as V,k as K,ad as re,A as $,ae as ue,j as G,H as F,bk as _e,an as pe,J as me,X as fe,F as T,O as J,a1 as X,a2 as Y,ah as ge,ai as ve,u as he,y as ye,r as Ve,S as H,bl as be,bm as Ce}from"./index-238de57f.js";import{_ as O}from"./AnimationBot1.vue_vue_type_script_setup_true_lang-6655a93a.js";import{W as ke}from"./style-74c83a5c.js";import{u as xe}from"./useSpeechService-82193284.js";const we=L({__name:"AnimationRecording",props:{size:{type:Number,default:500}},setup(d){const u=d;return(o,f)=>(i(),g(a(le),{animationLink:"https://assets10.lottiefiles.com/packages/lf20_jGOM8KIjDM.json",height:u.size,width:u.size,class:"animation-recording"},null,8,["height","width"]))}});const Se=S(we,[["__scopeId","data-v-d40988cd"]]);const Re={},ze={class:"loader"};function $e(d,u){return i(),p("span",ze)}const Ie=S(Re,[["render",$e],["__scopeId","data-v-34141737"]]);const Ae={},De={class:"loader"};function Me(d,u){return i(),p("span",De)}const Ne=S(Ae,[["render",Me],["__scopeId","data-v-facd6480"]]),Q=d=>(X("data-v-b1a6b0ad"),d=d(),Y(),d),Te={class:"ml-2 font-weight-bold"},Le=Q(()=>t("img",{src:"https://img.icons8.com/bubbles/50/null/lock-female-user.png"},null,-1)),Be=Q(()=>t("img",{src:"https://img.icons8.com/bubbles/50/null/user-male.png"},null,-1)),Ee={class:"full-h d-flex align-center"},Ue={class:"text-body-2 text-grey"},je={class:"text-body-2 ml-2"},Ke=L({__name:"VoiceConfigDialog",setup(d){const{getVoices:u}=xe(),o=P(),f=x([]),m=C=>{o.updateVoiceInfo(C)},v=x(["ja-JP","en-US","zh-CN","zh-HK"]),b=async()=>{const C=await u();f.value=C.filter(h=>v.value.includes(h.locale));const c=f.value.find(h=>h.shortName===o.speechSynthesisVoiceName);o.updateVoiceInfo(c)};return W(()=>o.voiceConfigDialog,()=>{b()}),ne(()=>{b()}),(C,c)=>{const h=J("RecycleScroller");return i(),p(T,null,[e(z,{variant:"elevated",icon:"",onClick:c[0]||(c[0]=l=>a(o).voiceConfigDialog=!0)},{default:s(()=>[e(N,{size:"30",class:"text-primary"},{default:s(()=>[r("mdi-cog-outline")]),_:1}),e(q,{activator:"parent",location:"top",text:"Voice Config"})]),_:1}),e(fe,{modelValue:a(o).voiceConfigDialog,"onUpdate:modelValue":c[4]||(c[4]=l=>a(o).voiceConfigDialog=l),width:"500"},{default:s(()=>[e(w,null,{default:s(()=>[e(ie,null,{default:s(()=>[e(M,null,{default:s(()=>[e(k,{cols:"12"},{default:s(()=>[e(w,{style:{"border-left":"5px solid #445573"}},{default:s(()=>[e(U,null,{default:s(()=>[r(" Voice Modal ")]),_:1}),e(j),e(ce,{elevation:"1",density:"compact"},{default:s(()=>[e(de,null,{default:s(()=>[t("span",null,"Total "+V(a(f).length)+" Voices",1),t("span",Te,[r("(Current Modal: "+V(a(o).localName)+" ",1),e(K,{density:"comfortable",class:"d-none d-sm-inline ml-1 font-weight-bold",label:"",size:"small",color:"primary"},{default:s(()=>[r(V(a(o).speechSynthesisLanguage),1)]),_:1}),r(" )")])]),_:1}),e(h,{class:"scroller",items:a(f),"item-size":50,"key-field":"name"},{default:s(({item:l})=>[e(re,{"active-color":"primary",onClick:E=>m(l),active:l.shortName===a(o).speechSynthesisVoiceName,"three-line":""},{prepend:s(()=>[l.gender===1?(i(),g($,{key:0,size:"30",color:"red"},{default:s(()=>[Le]),_:1})):(i(),g($,{key:1,size:"30",color:"blue"},{default:s(()=>[Be]),_:1}))]),append:s(()=>[t("div",Ee,[t("span",Ue,[e(K,{size:"small",class:"font-weight-bold",color:"blue"},{default:s(()=>[r(V(l.locale),1)]),_:2},1024)])])]),default:s(()=>[t("div",null,[e(ue,{class:"font-weight-bold text-primary"},{default:s(()=>[r(V(l.localName)+" ",1),t("span",je,"("+V(l.shortName)+")",1)]),_:2},1024)])]),_:2},1032,["onClick","active"])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1}),e(k,{cols:"12"},{default:s(()=>[e(w,{style:{"border-left":"5px solid #445573"}},{default:s(()=>[e(U,null,{default:s(()=>[r(" Voice Config ")]),_:1}),e(j),e(G,null,{default:s(()=>[e(M,{class:"align-center"},{default:s(()=>[e(k,{cols:"12",sm:"2",class:"pb-sm-3 pb-0"},{default:s(()=>[e(F,{class:"font-weight-medium"},{default:s(()=>[r("Rate")]),_:1})]),_:1}),e(k,{cols:"12",sm:"10"},{default:s(()=>[e(_e,{modelValue:a(o).voiceRate,"onUpdate:modelValue":c[1]||(c[1]=l=>a(o).voiceRate=l),"thumb-label":"always",min:.1,max:2,step:.1,"hide-details":""},null,8,["modelValue","min","step"])]),_:1})]),_:1}),e(M,{class:"align-center mb-3"},{default:s(()=>[e(k,{cols:"12",sm:"2",class:"pb-sm-3 pb-0"},{default:s(()=>[e(F,{class:"font-weight-medium"},{default:s(()=>[r("Emotion")]),_:1})]),_:1}),e(k,{cols:"12",sm:"10"},{default:s(()=>[e(pe,{modelValue:a(o).voiceEmotion,"onUpdate:modelValue":c[2]||(c[2]=l=>a(o).voiceEmotion=l),variant:"outlined","hide-details":"",density:"compact",items:a(o).styleList},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(me,null,{default:s(()=>[e(z,{color:"primary",block:"",onClick:c[3]||(c[3]=l=>a(o).voiceConfigDialog=!1)},{default:s(()=>[r("Close ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}});const Fe=S(Ke,[["__scopeId","data-v-b1a6b0ad"]]),B=d=>(X("data-v-41860388"),d=d(),Y(),d),He={class:"chat-bot"},Oe={class:"messsage-area"},Pe={key:0},We={class:"pa-5 user-message"},qe=B(()=>t("img",{src:ae,alt:"alt"},null,-1)),Ge={key:1},Je={class:"pa-5 assistant-message"},Xe=B(()=>t("img",{src:oe,alt:"alt"},null,-1)),Ye={key:0},Qe={class:"pa-6"},Ze={class:"message"},es={key:1,class:"no-message-container"},ss=B(()=>t("h1",{style:{color:"#4d5271"},class:"text-h3 text-md-h2 font-weight-bold"}," Talk With Me ",-1)),ts={class:"input-area"},as={class:"panel-left"},os={class:"panel-center"},ls={class:"panel-right"},ns=L({__name:"VoiceBot",setup(d){const u=ge(),o=ve(),f=P(),m=x([{content:"想象我们是朋友,和我进行轻松有趣的对话。我们可以聊天天气、音乐、电影、运动或者日常生活等话题。请尽情地与我互动并回应我的问题,让我们像朋友一样自然地交流。并且我会多种语言,我会用不同的语言跟你交流,比如说我当前的问题是中文时,希望你下个回答用中文,我当前的问题是英文时,你的下个回答用英文,我当前的问题是日语时,你的下个回答是日语",role:"system"}]),v=x(""),b=x(!1),C=async()=>{v.value&&(m.value.push({content:v.value,role:"user"}),_.isRecording=!1,_.isResponse=!0,await c(),v.value="")},c=async()=>{if(!o.getApiKey){u.showErrorMessage("请先输入API KEY"),b.value=!1;return}try{const n=await Ce({messages:m.value,model:"gpt-3.5-turbo",temperature:1,n:1,max_tokens:200},o.getApiKey);b.value=!1,m.value.push({content:n.data.choices[0].message.content,role:"assistant"}),_.isResponse=!1,f.ssmlToSpeak(n.data.choices[0].message.content)}catch(n){_.isResponse=!1,u.showErrorMessage(n.message)}},h=()=>{const n=document.querySelector(".message-container");setTimeout(()=>{n==null||n.scrollTo({top:n==null?void 0:n.scrollHeight})},100)};W(()=>m.value,n=>{n&&h()},{deep:!0});const l=x(),E=async()=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(n=>{l.value=new MediaRecorder(n);const I=[];l.value.start(),_.isRecording=!0,l.value.ondataavailable=R=>{I.push(R.data)},l.value.onstop=async R=>{const y=new Blob(I,{type:"audio/wav"}),A=new File([y],"recording.wav",{type:"audio/wav"}),D=new FormData;D.append("file",A),D.append("model","whisper-1");const se=await be(D,o.getApiKey);v.value=se.data.text,n.getTracks().forEach(te=>te.stop()),v.value?C():_.isRecording=!1}}).catch(n=>{u.showErrorMessage(n.message)})},Z=()=>{l.value&&(l.value.stop(),_.isRecording=!1,_.isResponse=!0)},_=he({isRecording:!1,isResponse:!1}),ee=()=>{m.value=[{content:"想象我们是朋友,和我进行轻松有趣的对话。我们可以聊天天气、音乐、电影、运动或者日常生活等话题。请尽情地与我互动并回应我的问题,让我们像朋友一样自然地交流。并且我会多种语言,我会用不同的语言跟你交流,比如说我当前的问题是中文时,希望你下个回答用中文,我当前的问题是英文时,你的下个回答用英文,我当前的问题是日语时,你的下个回答是日语",role:"system"}]};return(n,I)=>{const R=J("perfect-scrollbar");return i(),p("div",He,[t("div",Oe,[a(m).length>1?(i(),g(R,{key:0,class:"message-container"},{default:s(()=>[(i(!0),p(T,null,Ve(a(m),y=>(i(),p(T,null,[y.role==="user"?(i(),p("div",Pe,[t("div",We,[e($,{class:"ml-4",rounded:"lg",variant:"elevated"},{default:s(()=>[qe]),_:1}),e(w,{class:"gradient gray rounded-xl rounded-be-0",theme:"dark"},{default:s(()=>[e(G,null,{default:s(()=>[t("b",null,V(y.content),1)]),_:2},1024)]),_:2},1024)])])):y.role==="assistant"?(i(),p("div",Ge,[t("div",Je,[e($,{class:"mr-4",rounded:"sm",variant:"elevated"},{default:s(()=>[Xe]),_:1}),e(w,{class:"rounded-xl rounded-bs-0"},{default:s(()=>[t("div",null,[e(a(ke),{modelValue:y.content,"onUpdate:modelValue":A=>y.content=A,previewOnly:""},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024)])])):H("",!0)],64))),256)),a(b)?(i(),p("div",Ye,[t("div",Qe,[t("div",Ze,[e(O,{size:100})])])])):H("",!0)]),_:1})):(i(),p("div",es,[ss,e(O,{size:300})]))]),t("div",ts,[e(ye,{class:"input-panel",height:"100"},{default:s(()=>[t("div",as,[t("span",null,[e(Fe)])]),t("div",os,[a(_).isRecording?(i(),g(Se,{key:0,onClick:Z,size:140})):a(_).isResponse?(i(),g(Ne,{key:1})):a(f).isPlaying?(i(),g(Ie,{key:2})):(i(),g(z,{key:3,size:"x-large",icon:"",variant:"elevated",class:"gradient gray",onClick:E},{default:s(()=>[e(N,{size:"30"},{default:s(()=>[r("mdi-microphone")]),_:1})]),_:1}))]),t("div",ls,[e(z,{icon:"",variant:"elevated",onClick:ee},{default:s(()=>[e(N,{size:"30",class:"text-primary"},{default:s(()=>[r("mdi-broom")]),_:1}),e(q,{activator:"parent",location:"top",text:"Clear"})]),_:1})])]),_:1})])])}}});const ps=S(ns,[["__scopeId","data-v-41860388"]]);export{ps as default};
